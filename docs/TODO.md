# gh-stats TODO / 备忘录

记录待验证的优化想法和功能计划。

---

## 待验证

### [ ] Events API 对公开组织的覆盖范围

**问题**: 当使用 `--user jack --orgs xxx` 查询别人在某组织的贡献时，目前强制扫描组织内所有仓库。这是因为担心 Events API 看不到别人在私有 org repos 里的活动。

**待验证**:
- 对于**公开组织**，Events API 是否能看到所有成员的公开活动？
- 如果可以，90 天内的查询可以只扫描 Events API 发现的 repos，大幅减少 API 调用。

**验证方法**:
1. 找一个公开组织
2. 用 Events API 查询某个成员的活动
3. 对比全量扫描的结果
4. 确认是否有遗漏

**相关代码**: `src/gh_stats/discovery.py` 第 57-99 行

---

### [ ] Lock 文件变更扭曲统计

**问题**: 依赖管理的 lock 文件（如 `package-lock.json`, `pnpm-lock.yaml`, `yarn.lock`）单个文件可能有数万行。当项目切换包管理器（如 npm → pnpm）时，删除旧 lock 文件会导致删除行数激增，无法真实反映工作量。

**案例**: gxfang1985 12 月删除 23 万行，主要原因是多个项目从 npm 切换到 pnpm。

**可能的解决方案**:
- `--exclude-lockfiles` 选项：自动排除常见 lock 文件
- 在报告中单独展示 lock 文件变更，不计入主要指标

**优先级**: 低（记录备忘，暂不处理）

---

## 功能计划

### [ ] 缓存机制

考虑添加 repo 列表缓存，避免每次都重新获取 org repos 列表。

### [ ] 增量扫描

对于频繁查询，考虑实现增量扫描，只扫描上次查询后有更新的 repos。

---

## 已完成

### [x] Dry-run 模式 (2026-01-11)

实现 `--dry-run` 参数，用于诊断参数解析行为。
